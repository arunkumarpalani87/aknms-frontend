(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,n){e.exports=n(28)},28:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),l=n.n(o),c=n(1),s=n(2),i=n(4),u=n(3),d=n(5),h=n(12),p=n.n(h),f={height:30,border:"1px solid green",margin:6,padding:8},m=(r.a.Component,r.a.Component,n(6)),g=n.n(m),v=n(7),b=n(13),y=n.n(b),C=function(e){function t(e){var n;return Object(c.a)(this,t),console.log("Calling EventsChart constructor"),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={chartdata:[]},console.log("EventsChart - state",n.state),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"fetchDataAsync",value:function(){var e=Object(v.a)(g.a.mark(function e(){var t,n,a,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8080/aknms/v1/event/count");case 2:return t=e.sent,e.next=5,t.json();case 5:for(n=e.sent,a=n.map(function(e){return{title:e.eventType,value:e.count}}),r=["#E38627","#C13C37","#6A2135","#846968"],o=0;o<a.length;o++)a[o].colour=r[o];return console.log("fetchData - chartData",a.then()),e.abrupt("return",a);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;fetch("http://localhost:8080/aknms/v1/event/count").then(function(e){return e.json()}).then(function(e){return e.map(function(e){var t={title:e.eventType,value:e.count};return console.log("componentDidMount - chartEntry",t),t}),e}).then(function(t){console.log("componentDidMount - chartEntry",t);for(var n=["#E38627","#C13C37","#6A2135","#846968"],a=0;a<t.length;a++)t[a].title=t[a].eventType,delete t[a].eventType,t[a].value=t[a].count,delete t[a].count,t[a].color=n[a];e.setState({chartdata:t}),console.log("componentDidMount - chartData",t)})}},{key:"render",value:function(){return console.log("Calling EventsChart Render"),console.log("Render - state",this.state),"undefined"===typeof this.state.chartdata||0===this.state.chartdata.length?r.a.createElement("div",null,r.a.createElement("b",null,"Loading Chart")):r.a.createElement("div",null,r.a.createElement(y.a,{data:this.state.chartdata,radius:30,style:{height:"300px"},animate:!0}))}}]),t}(r.a.Component),E=(r.a.Component,n(16)),w=n(14);var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rowdata:[],lastLoadedIndex:0},t=arguments.length>1?arguments[1]:void 0;switch(console.log("Reducer Action",t),t.type){case"LOAD_DATA":return console.log("Reducer table Mount - Curr State",e),console.log("Reducer table Mount - Action rowdata",t.rowdata),{rowdata:t.rowdata,lastLoadedIndex:t.lastLoadedIndex};default:return e}},O=Object(w.a)(D);var j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(n,a){if(!n.hasOwnProperty(e)||!a.hasOwnProperty(e))return 0;var r="string"===typeof n[e]?n[e].toUpperCase():n[e],o="string"===typeof a[e]?a[e].toUpperCase():a[e],l=0;return r>o?l=1:r<o&&(l=-1),"desc"===t?-1*l:l}},x=function(e){function t(e){var n;return Object(c.a)(this,t),console.log("Calling InfiniteTable Constructor"),n=Object(i.a)(this,Object(u.a)(t).call(this,e)),O.subscribe(function(){n.forceUpdate()}),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"createRow",value:function(e){var t=[],n=[];for(var a in e)n.push(r.a.createElement("td",null,e[a]));return t.push(r.a.createElement("tr",null,n)),t}},{key:"componentDidMount",value:function(){var e=this;console.log("Calling componentDidMount"),this.loadData(this.props.initialRecordCount),this.refs.iScroll.addEventListener("scroll",function(){e.refs.iScroll.scrollTop+e.refs.iScroll.clientHeight>=e.refs.iScroll.scrollHeight&&e.loadData(e.props.additionalRecordCount)})}},{key:"loadData",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var n,a,r,o,l,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Calling loadData"),n=O.getState().lastLoadedIndex,e.next=4,fetch("http://localhost:8080/aknms/v1/event?id-from="+(n+1)+"&count="+t);case 4:return a=e.sent,e.next=7,a.json();case 7:if(0!==(r=e.sent).length){e.next=11;break}return console.log("loadData - fetch returned empty array"),e.abrupt("return");case 11:if(console.log("loadData - Before Sorting",r),o=Object(E.a)(r).sort(j("id","desc")),console.log("loadData - After Sorting",o),l=o[0].id,console.log("loadData - newlastLoadedIndex",l),l!==n){e.next=19;break}return console.log("loadData - returned value is already loaded"),e.abrupt("return");case 19:c=r.map(function(e){var t=e;return t.managementIp=e.managedElement.ipAddress,delete t.managedElement,t}),c=Object.assign([],O.getState().rowdata.concat(c)),O.dispatch({type:"LOAD_DATA",rowdata:c,lastLoadedIndex:l});case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;console.log("Calling Table Render");var t=this.props.headers;return void 0===t||0===t.length?r.a.createElement("div",{className:"infiniteTable",ref:"iScroll"},r.a.createElement("b",null,"Error - Table Headers Undefined")):(console.log("render - Headers",t),r.a.createElement("div",{className:"infiniteTable",ref:"iScroll",style:{height:"600px",overflow:"auto"}},r.a.createElement("table",{align:"center"},r.a.createElement("style",null,"table, th, td {border:1px solid black; border-collapse: collapse;}"),r.a.createElement("tr",null,t.map(function(e){return r.a.createElement("th",null,e.headername)})),O.getState().rowdata.map(function(t){return e.createRow(t)}))))}}]),t}(r.a.Component);x.defaultProps={initialRecordCount:50,additionalRecordCount:20};var k=x,A=function(e){function t(e){var n;return Object(c.a)(this,t),console.log("Calling EventsPage Constructor"),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).headers=[{headername:"ID",fieldname:"id"},{headername:"Timestamp",fieldname:"timestamp"},{headername:"Log Message",fieldname:"message"},{headername:"Log Type",fieldname:"type"},{headername:"ManagementIP",fieldname:"managementip"}],n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"AK NMS Events"),r.a.createElement(C,null),r.a.createElement(k,{headers:this.headers,initialRecordCount:"50",additionalRecordCount:"10"}))}}]),t}(r.a.Component);l.a.render(r.a.createElement(A,null),document.getElementById("eventsPage"))}},[[17,2,1]]]);
//# sourceMappingURL=main.9a3c3ead.chunk.js.map